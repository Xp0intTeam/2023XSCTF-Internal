from Crypto.Util.number import *
from secret import flag1,flag2

A = 46056180
B = 2316783294673
M = 146808027458411567

E = EllipticCurve(GF(M),[0,0,0,A,B])
P = E.random_point()
assert P == E([93186182165941641,39307479349615830])

k1 = bytes_to_long(flag1)
Q = k1*P
assert Q == E([42955059317199855,130306406465113487])

p = 12120097265289978947461755693181106372674461675333874346782011944193533397194631828066169420993129594436059900844801285250951977172337688714330810305520675260007257082615881150041780945521937736657530123863384192909336128663379931792536667
g = getStrongPrime(768)

assert g == 1541811002641460434777002733641874469811239753131105140001545962475014255533451514061819671911559309617286062751898456804727245163614200218187513789759420325834412598630560635886330337863304850573524337161249340820629482648622465423

k2 = bytes_to_long(flag2)
y = pow(a,k2,p)

assert y == 232917465707973847011449900772432880023241192182527765389647826253964954133729102602203278760495775275455448004235911629179322220125919296953420088412024171315869121267353651703894786164666636198864687118542546670251643401163520881530674

#flag = HSCTF{flag1+flag2}



