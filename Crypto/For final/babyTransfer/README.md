- **题目名称：** babyTransfer
- **题目类型：** Crypto
- **题目难度：**困难
- **出题人：** =w=
- **考点：**

1. 理解 1-2 Oblivious transfer 的概念
2. 构造合适的数

- **描述：** 
- **flag：** XSCTF{this_is_the_R3al_fl4g_It_i5_a_baby_0b1ivious_Transfer}
- **Writeup：**

不经意传输协议(Oblivious Transfer protocol, OT)是一种可保护隐私的双方通信协议，能使通信双方以一种选择模糊化的方式传送消息。使得接收方以不经意的方式得到发送方输入的某些消息，这样就可以保护接收者的隐私不被发送者所知道。Alice 有两个秘密 m0 和 m1 ，Bob 有一个私有的 𝑏 ∈ {0,1}，通过执行协议，Bob 最终获得一个秘密 $m_b$，但他不能同时获得$m_{1−𝑏}$，且 Alice 不知道 Bob 拿到的是哪一个秘密。 

题目实现了一个不安全的OT协议，服务器充当Alice，我们充当Bob，要求我们同时获得 m0和m1.

因为我们并不在乎服务器知不知道我们选的是哪条消息，所以我们不需要模糊我们的消息，直接v=x0 + 1发送过去，k0就会是1，服务器再返回的m0就是我们要的m0。那么为了得到 m1，我们需要解出 k1。注意到，**如果发起多次连接，RSA还是不变的**。为此，我们保持第一个连接不断，同时发起新的连接，并使用精心构造的 v，让新连接中的 k1' 和第一个连接的 k1 保持相同，然后将第一个连接的m1和第二个连接的m1求个公因子就行了。易得，满足这样条件的 v 就是 x0+1-x1+x1'。

题目给了 600 秒的反应时间，支持手打。